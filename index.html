<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>ORBIS v2 (.1)</title>
  <link type="text/css" rel="stylesheet" href="orbis.css" />
  <meta charset="utf-8" />
</head>

<body>
  <div id="essayBox" onclick="closeEssay()">
      <span id="infoclosebutton" style="top:5px;right:5px;z-index:1;" onclick="closeEssay()" >X</span>
  </div>
    <div id="essayContent">
      
    </div>
  <div id="topbar"><div id="title">ORBIS 2.0 (beta)</div>
    <div class="navtab" data="intro">Introducing ORBIS</div>
    <div class="navtab" data="understand">Understanding ORBIS</div>
    <div class="navtab" data="build">Building ORBIS</div>
    <div class="navtab" data="tutorial">Using ORBIS</div>
    <div class="navtab" data="gallery">Map Gallery</div>
    <div class="navtab" data="scholarship">Research</div>
    <div class="navtab" data="media">ORBIS in the Media</div>
    <div class="navtab" data="credits">Credits</div>
    <div class="navtab" data="news">What's New</div>
    <div id="authors"><a href="http://www.stanford.edu/~scheidel/">Walter Scheidel</a> <a href="https://dhs.stanford.edu">Elijah Meeks</a></div></div>
  <div id="restoreButton" style="display: none;position: fixed; top:50px; left:30px;"><button style="cursor:pointer;" onclick="restoreControlsMap();">Controls</button></div>
  <div class="controlsDiv" style="position: fixed; bottom:10px; right:10px; background: white;">
    <a href="https://github.com/emeeks/orbis_v2"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </div>

  <div id="vizcontainer">
    <div id="legendmodal" class="popup">
      <span id="infoclosebutton" onclick="d3.select('#legendmodal').style('display','none')" >X</span>
      <svg id="legendSVG"></svg>
    </div>
    <div id="routemodal" class="modal"></div>
    <div id="sitemodal" class="modal"></div>
    <div id="clustermodal" class="modal">
      <span id="infoclosebutton" onclick="d3.select('#clustermodal').style('display','none')" >X</span>
      <p id="clustercontent"></p>
    </div>
    <div id="infopopup" class="popup">
      <span id="infoclosebutton" onclick="d3.select('#infopopup').style('display','none')" >X</span>
      <div id="infocontent">
    <p>Welcome to ORBIS v2 (beta)</p>
    <p>Please send any bugs or feature requests or other feedback to <a href="mailto:emeeks@stanford.edu">Elijah Meeks (emeeks@stanford.edu)</a></p>
    </div>
      <button class="multiSiteControl" onclick="massSiteChange('off')">Exclude these sites</button><button class="multiSiteControl" onclick="massSiteChange('on')">Include these sites</button>
      <button class="multiSiteControl" onclick="massSiteChange('intersect')">Only These Sites</button><button class="multiSiteControl" onclick="massSiteChange('exclude')">All Sites But These</button>
      <button class="multiSiteControl" onclick="massSiteChange('all')">All Sites</button><button class="multiSiteControl" onclick="massSiteChange('none')">No Sites</button>
      </div>
    <div id="tutorialpopup" class="tutorial">
      <span id="infoclosebutton" onclick="d3.select('#tutorialpopup').style('display','none')" >X</span>
      <div id="tutorialarrow" style="width:20px;height:20px;transform: rotate(45deg);-ms-transform: rotate(45deg);-webkit-transform: rotate(45deg);background:white;  border-left: solid 2px lightgray;border-top: solid 2px lightgray;position:absolute;left:20px;top:-12px;"></div>
      <div id="tutorialcontent">
        <p>Here's some tutorial content.</p>
      </div>
    </div>

  </div>
    <div class="controlsDiv" style="position: fixed; top: 10%; right: 0px; height:100px; width: 200px; background:#F8F8F8;">
    <div class="buttonContainer" style="width: 180px;">
      <p>
      <button onclick="zoomManual('in');">Zoom in</button>
      <button onclick="zoomManual('out');">Zoom out</button>
      <button onclick="fullscreenMap();">Full Screen</button>
      </p>
      <p>
      <button id="startBrushingButton" onclick="startBrushing();">Select Sites</button>
      <button id="stopBrushingButton" style="display:none;" onclick="stopBrushing();">Stop Selecting</button>
      </p>
      <p>
      <button onclick="createVoronoi();">Regions</button><img data="voronoi" class="helpicon" src="helpq.png" />
      </p>
      <p>
      <button onclick="clusterSitesUI()">Cluster</button><img data="cluster" class="helpicon" src="helpq.png" />
      </p>
      <p>
      <button onclick="exportSVG();">Export SVG</button><img data="exportsvg" class="helpicon" src="helpq.png" />
      </p>
      <p>
      <button onclick="">Tutorial</button>
      <button onclick="mapOff();">Terrain</button>
      <button onclick="temporaryLabels();">Labels</button>
      </p>
      <p>
      <button class="controlButton" onclick="cartogramOff()">Cartogram Off</button>
      <button id="sankeyButton" style="display:none;" onclick="sankeyOff();">Minard Off</button>
      </p>
      <button style="display:none;" onclick="testCommunities(exposedsites,exposedroutes,d3.selectAll('g.site'))">Network Communities</button>
      <p><a id="svgDownload">Download SVG</a></p>
      <p>You can also browse routes and cartograms run on ORBIS:</p>
      <button onclick="d3.select('#controlbar').style('display', 'none');d3.selectAll('#resultsTable').style('display', 'block');d3.selectAll('.resultsRow').style('display', 'none');d3.selectAll('.routeRow').style('display','block');d3.selectAll('tr.routeRow').style('display','table-row');">Routes</button>
      <button onclick="d3.select('#controlbar').style('display', 'none');d3.selectAll('#resultsTable').style('display', 'block');d3.selectAll('.resultsRow').style('display', 'none');d3.selectAll('.cartoRow').style('display','block');d3.selectAll('tr.cartoRow').style('display','table-row');">Cartograms</button>
      <p>Color the network by priority to get a sense of how the network changes based on priority.</p>
      <button id="eButton" class="routeLabelButton controlButton" onclick="colorBy('e')">Expense</button> <button id="sButton" class="routeLabelButton controlButton" onclick="colorBy('s')">Speed</button> <button id="tButton" class="routeLabelButton controlButton active" onclick="colorByType()">Type</button>
    </div>
    </div>

  <div class="controlsDiv" id="controlbar" style="position: fixed; top: 10%; left: 0px; height:80%; width: 230px; background:#F0F0F0;">
    <a class="tab" onmouseover="contextualHelp('route')" onmouseout="d3.select('#infopopup').style('display','none')" onclick="switchControls('route');" style="left:5px;">Route</a>
    <a class="tab backtab" onmouseover="contextualHelp('cartogram')" onmouseout="d3.select('#infopopup').style('display','none')" onclick="switchControls('cartogram');" style="left:59px;">Cartogram</a>
    <a class="tab backtab" onmouseover="contextualHelp('minard')" onmouseout="d3.select('#infopopup').style('display','none')" onclick="switchControls('Minard');" style="left:147px;">Minard</a>
    <div class="buttonContainer" style="width:140px">
      <select id="sourceSelectButton" class="controlButton">
        </select> <select id="targetSelectButton" class="controlButton">
        </select>
            <fieldset id="directionPicker" style="display: none;">
      <input type="radio" name="direction" value="0" id="from" checked>
      <label for="from" class="direction-picker-label">From</label>
      <input type="radio" name="direction" value="1" id="to">
      <label for="to" class="direction-picker-label">To</label>
            </fieldset>
    </div>
    <div class="buttonContainer">
      <fieldset id="monthPicker">
      <input type="radio" name="month" value="1" id="jan">
      <label for="jan" class="month-picker-label">Jan</label>
      <input type="radio" name="month" value="2" id="feb">
      <label for="feb" class="month-picker-label">Feb</label>
      <input type="radio" name="month" value="3" id="mar">
      <label for="mar" class="month-picker-label">Mar</label>
      <input type="radio" name="month" value="4" id="apr">
      <label for="apr" class="month-picker-label">Apr</label>
      <input type="radio" name="month" value="5" id="may">
      <label for="may" class="month-picker-label">May</label>
      <input type="radio" name="month" value="6" id="jun">
      <label for="jun" class="month-picker-label">Jun</label>
      <input type="radio" name="month" value="7" id="jul">
      <label for="jul" class="month-picker-label">Jul</label>
      <input type="radio" name="month" value="8" id="aug">
      <label for="aug" class="month-picker-label">Aug</label>
      <input type="radio" name="month" value="9" id="sep" checked="">
      <label for="sep" class="month-picker-label">Sep</label>
      <input type="radio" name="month" value="10" id="oct">
      <label for="oct" class="month-picker-label">Oct</label>
      <input type="radio" name="month" value="11" id="nov">
      <label for="nov" class="month-picker-label">Nov</label>
      <input type="radio" name="month" value="12" id="dec">
      <label for="dec" class="month-picker-label">Dec</label>
    </fieldset>
    </div>

    <div class="buttonContainer">
      <form id="priorityForm"><input type="radio" value="0" name="priority" checked>Fastest</input><input type="radio" value="1" name="priority">Cheapest</input><input type="radio" value="2" name="priority">Shortest</input></form>
    </div>

    <div class="buttonContainer">
  Modes</div>
    <div class="buttonContainer" style="width:210px">
      <form id="modeForm" onclick="updateBGRoutes();">
        <div class="checkboxDiv">
        <input type="checkbox" value="road" name="mode" checked>Road</input>
        </div>
        <div class="checkboxDiv">
        <input id="riverModeCheck" type="checkbox" value="upstream,downstream" name="mode" checked>River</input>
        </div>
        <div class="checkboxDiv">
        <input id="coastModeCheck" type="checkbox" value="coastal" name="mode" checked>Coastal</input>
        </div>
        <div class="checkboxDiv">
        <input id="overseasModeCheck" type="checkbox" value="overseas" name="mode" checked>Open Sea</input>
        </div>
        <div class="checkboxDiv">
        <input type="checkbox" value="hires" name="mode">High Resolution</input>
        </div>
      </form>

    </div>
    <div class="buttonContainer">
Aquatic Options</div>

    <div class="buttonContainer">
      <input type="radio" name="riverSwitch" onclick="d3.select('#riverModeCheck').node().value = 'upstream,downstream';" checked>Civilian</input>
      <input type="radio" name="riverSwitch" onclick="d3.select('#riverModeCheck').node().value = 'fastup,fastdown';">Military</input>
    </div>
    <div class="buttonContainer">
      <input type="radio" name="seaSwitch" onclick="d3.select('#overseasModeCheck').node().value = 'overseas';d3.select('#coastModeCheck').node().value = 'coastal';" checked>Fast</input>
      <input type="radio" name="seaSwitch" onclick="d3.select('#overseasModeCheck').node().value = 'slowsea';d3.select('#coastModeCheck').node().value = 'slowcoast';">Slow</input>
      <input type="radio" name="seaSwitch" onclick="d3.select('#overseasModeCheck').node().value = '';d3.select('#coastModeCheck').node().value = 'dayfast';">Daylight</input>
      <img data="shipmodel" class="helpicon" src="helpq.png" />
    </div>

    <div class="buttonContainer" style="width:190px">
      Vehicle Type <select id="vehicleSelectButton" style="width:170px;" class="controlButton" onclick="colorBy('e')">
        </select> Transfer cost: <input type="text" style="width:30px;" id="transferCost" class="controlButton" onclick="colorByType()" /> days<img data="transfer" class="helpicon" src="helpq.png" />
        <button style="margin-left:50px;">Advanced</button><img data="advanced" class="helpicon" src="helpq.png" /> 
    </div>

    <div style="background:lightred" class="buttonContainer">
      <button class="controlButton calculateButton" id="routeCalculateButton" onclick="calculateRoute()">Calculate Route</button>
      <button class="controlButton calculateButton" id="cartoCalculateButton" style="display:none;" onclick="calculateCarto()">Calculate Cartogram</button>
      <button class="controlButton calculateButton" id="sankeyCalculateButton" style="display:none;" onclick="calculateSankey()">Minard Diagram</button>
          <div id="routeResults" class="modal"></div>
    </div>
  </div>
      <div id="resultsTable" style="display:none;background:white;border:1px black solid;position:absolute;left:0px;top:10%;height:80%;width:540px;overflow: hidden;z-index: 99;">
      <div>
        <button onclick="d3.selectAll('.resultsRow').style('display', 'none');d3.selectAll('.cartoRow').style('display','block');d3.selectAll('tr.cartoRow').style('display','table-row');">Cartograms</button>
        <button onclick="d3.selectAll('.resultsRow').style('display', 'none');d3.selectAll('.routeRow').style('display','block');d3.selectAll('tr.routeRow').style('display','table-row');">Routes</button>
        <button onclick="d3.selectAll('.resultsRow').style('display', 'block');d3.selectAll('tr.resultsRow').style('display','table-row');">All</button>
        <button onclick="d3.selectAll('.resultsContainer').style('display', 'none');d3.selectAll('#recentGrid').style('display', 'block');">Grid View</button>
        <button onclick="d3.selectAll('.resultsContainer').style('display', 'none');d3.selectAll('#recentList').style('display', 'block');">List View</button>
        <button onclick="d3.selectAll('.resultsContainer').style('display', 'none');d3.selectAll('#recentTable').style('display', 'block');">Table View</button>
        <button onclick="d3.select('#controlbar').style('display', 'block');d3.selectAll('#resultsTable').style('display', 'none');">CLOSE</button>
      </div>
      <div id="recentList" class="resultsContainer" style="overflow: auto;height:520px;border-top:1px lightgray solid;">
      </div>
      <div id="recentGrid" class="resultsContainer" style="display:none;overflow: auto;height:520px;border-top:1px lightgray solid;">
      </div>
      <div id="recentTable" class="resultsContainer" style="display:none;overflow: auto;height:520px;border-top:1px lightgray solid;">
        <table style="width:540px;">
          <caption>Results</caption>
          <thead>
            <tr>
              <th>Start</th>
              <th>End</th>
              <th>Priority</th>
              <th>Month</th>
              <th>Vehicle</th>
              <th>Thumb</th>
            </tr>
            <tbody id="recTableActual">
              
            </tbody>
          </thead>
        </table>
      </div>
    </div>
      <div id="sankeyChart">
        <svg width="100%" height="100%"></svg>
      </div>
  <div id="timelineViz">
    <a id="tlbPerspective" class="tab" style="left:20px;" >Perspective</a>
    <a id="tlbDuration" class="tab backtab" style="left:116px;" >Duration</a>
    <a id="tlbDistance" class="tab backtab" style="left:188px;" >Distance</a>
    <a id="tlbExpensed" class="tab backtab" style="left:263px;" >Expense (D)</a>
    <a id="tlbExpensew" class="tab backtab" style="left:359px;" >Expense (W)</a>
    <a id="tlbExpensec" class="tab backtab" style="left:459px;" >Expense (C)</a>
    <a id="infoclosebutton" onclick="d3.select('#routesContainer').style('opacity', 1);d3.select('#timelineViz').style('display','none');" >X</a>
<svg id="timelineSVG" width="100%" height="100%">
  <g id="tlXAxis" class="tlAxis" transform="translate(0,100)"></g>
  <g id="tlYAxis" class="tlAxis" transform="translate(60,0)"></g>
  <text id="tlYLabel" x="10" y="15">Longitude</text>
  <text id="tlXLabel" x="90" y="115">Latitude</text>
</svg>

  </div>
  <div class="footer">
Published by <a href="http://library.stanford.edu">Stanford University Libraries</a> | <span style="font-size:9px;">Tiles &#169; <a href="http://awmc.unc.edu/wordpress/tiles/map-tile-information">AWMC</a>, CC BY-NC 3.0</span>
</div>
  <footer>
    <script src="o_settings.js" type="text/javascript">
</script> <script src="d3.v3.min.js" type="text/javascript">
</script> <script src="d3.geo.tile.v0.min.js" type="text/javascript">
</script> <script src="topojson.js" type="text/javascript">
</script> <script src="colorbrewer.js" type="text/javascript">
</script> <script src="legend.js" type="text/javascript">
</script> <script src="clipper.js" type="text/javascript">
</script> <script src="orbis.js" type="text/javascript">
</script> <script src="community.js" type="text/javascript">
</script> <script src="sankey.js" type="text/javascript">
</script>
  </footer>
</body>
</html>
